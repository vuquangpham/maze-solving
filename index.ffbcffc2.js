class t{constructor(t=null,e=null){this.parent=t,this.position=e,this.g=0,this.h=0,this.f=0,this.depth=0,this.parent&&this.depth++}equal(t){return this.position.equal(t.position)}expand(t){const e=[];for(const s of t.actions(this)){const o=this.child_node(t,s);e.push(o)}return e}child_node(e,s){const o=e.result(this.position,s);return new t(this,o)}solution(){const t=[];for(const e of this.path())t.push(e.position);return t}path(){let t=this;const e=[];for(;t;)e.push(t),t=t.parent;return e.reverse()}}class e{constructor(t){this.element=t,this.next=null}}class s{constructor(){this.head=this.tail=null,this.size=0}enqueue(t){const s=new e(t);if(null===this.head)return this.head=this.tail=s,void this.size++;s.next=this.head,this.head=s,this.size++}dequeue(){if(null===this.head)return null;const t=this.head;return this.head=this.head.next,t.next=null,this.size--,t.element}find(t){let e=this.head;for(;e;){if(console.log("node element == elemnt",e.element,t,e.element===t),e.element===t)return!0;e=e.next}return!1}}const o=(t,e)=>t.some(((s,o)=>t[o].equal(e))),n=t=>[+t.dataset.row,+t.dataset.col],i=(t,e)=>t.classList.contains(e);class a{static create(t,e,s=["box"]){const o=document.createElement("div");return o.classList.add(...s),Object.assign(o.style,{width:`${t}px`,height:`${e}px`}),o}static generateMiddlePoint(t){const e=t.getBoundingClientRect();let s=e.x,o=e.y;return[s+e.width/2,o+e.height/2]}}class r{isMouseDown=!1;currentCursorBox=null;constructor(t,e,s,o){this.parentElm=t,this.width=e,this.height=s,this.maze=[],this.row=0,this.col=0,this.svg=o}repeat(t){let e="";for(let s=0;s<t;s++)e+="1fr ";return e.trim()}drawBox(t,e){t.removeAttribute("class"),t.classList.add("box",...e),(e.includes("start")||e.includes("goal"))&&t.setAttribute("draggable","true")}resetPath(){document.querySelectorAll(".expand").forEach((t=>{t.classList.remove("expand")})),this.svg.innerHTML=""}resetObstacle(){document.querySelectorAll(".obstacle").forEach((t=>{const e=+t.dataset.row,s=+t.dataset.col;this.maze[e][s]=0,t.classList.remove("obstacle")})),this.resetPath()}drawLine(t){let e="",s=!0;for(const o of t){const t=o[0],n=o[1],i=document.querySelector(`div[data-row="${t}"][data-col="${n}"]`),[r,l]=a.generateMiddlePoint(i);s?(e+=`M ${r},${l}`,s=!1):e+=` L ${r}, ${l}`}return e}moveBox(t,e){const s=e.dataset.row,o=e.dataset.col,n=t.dataset.row,i=t.dataset.col,a=e.nextElementSibling,r=e.parentNode;t.replaceWith(e),r.insertBefore(t,a),t.dataset.row=s,t.dataset.col=o,e.dataset.row=n,e.dataset.col=i}drawPath(t){for(const e of t){const t=e[0],s=e[1],o=document.querySelector(`div[data-row="${t}"][data-col="${s}"]`);o.classList.contains("start")||o.classList.contains("goal")||this.drawBox(o,["expand"])}}generateState(){return[Math.round(Math.random()*this.row),Math.round(Math.random()*this.row)]}createInitialState(t,e){const[s,o]=t,[n,i]=e,a=document.querySelector(`div[data-row="${s}"][data-col="${o}"]`),r=document.querySelector(`div[data-row="${n}"][data-col="${i}"]`);this.drawBox(a,["start"]),this.drawBox(r,["goal"])}createBox(){for(let t=0;t<this.row;t++){for(let e=0;e<this.col;e++){const s=a.create(this.width,this.height);s.dataset.row=t,s.dataset.col=e,this.parentElm.append(s)}this.maze.push(Array(this.col).fill(0))}}reset(){this.parentElm.innerHTML=""}createGrid(){this.reset();const t=window.innerWidth,e=window.innerHeight;this.col=Math.ceil(t/this.width),this.row=Math.ceil(e/this.height),Object.assign(this.parentElm.style,{gridTemplateColumns:`repeat(${this.col}, 1fr)`,gridTemplateRows:`repeat(${this.row}, 1fr)`}),this.createBox();let s=this.generateState(),o=this.generateState();return this.createInitialState(s,o),[s,o]}updateMaze(t,e){0===this.maze[t][e]?this.maze[t][e]=1:this.maze[t][e]=0}handleMouseDown(t){const e=t.target.closest(".box");if(!e||e.classList.contains("start")||e.classList.contains("goal"))return;this.isMouseDown=!0,this.currentCursorBox=e;const s=e.dataset.row,o=e.dataset.col;this.updateMaze(s,o),e.classList.toggle("obstacle"),this.resetPath()}handleMouseUp(t){this.isMouseDown=!1}handleMouseMove(t){if(!this.isMouseDown)return;const e=t.target.closest(".box");if(!e||e.classList.contains("start")||e.classList.contains("goal"))return;if(this.currentCursorBox==e)return;this.currentCursorBox=e;const s=e.dataset.row,o=e.dataset.col;this.updateMaze(s,o),e.classList.toggle("obstacle")}}class l{constructor(t,e,s){this.maze=t,this.start=e,this.goal=s,this.diagonal=!0,this.row=this.maze.length,this.col=this.maze[0].length,Array.prototype.equal=function(t){return this.length===t.length&&this.every(((e,s)=>e===t[s]))}}updateDiagonal(t){this.diagonal=!0===t}updateState(t,e){this.start=t,this.goal=e}actions(t){const e=[],s=this.diagonal?[[0,-1],[0,1],[-1,0],[1,0],[-1,-1],[-1,1],[1,-1],[1,1]]:[[0,-1],[0,1],[-1,0],[1,0]];for(const o of s){const s=[t.position[0]+o[0],t.position[1]+o[1]];s[0]>this.row-1||s[0]<0||s[1]>this.col-1||s[1]<0||0===this.maze[s[0]][s[1]]&&e.push(o)}return e}result(t,e){return[t[0]+e[0],t[1]+e[1]]}goal_test(t){return this.goal.equal(t)}}let c=[7,8],h=[30,32];const d=document.querySelector(".container"),u=document.querySelector(".btn--search"),g=document.querySelector("svg"),p=document.querySelector(".btn--clear"),f=document.querySelector(".btn--reset"),w=document.getElementById("selection"),m=document.querySelector("input[type='checkbox']");window.addEventListener("DOMContentLoaded",(()=>{const e=new r(d,30,30,g),a=e.maze;[c,h]=e.createGrid();const v=document.querySelectorAll('div[draggable="true"]'),x=new l(a,c,h);let L=null,b=0;console.log(g),g.height=window.innerHeight,g.width=window.innerWidth,window.addEventListener("resize",(function(t){b&&clearTimeout(b),b=setTimeout((function(t){[c,h]=e.createGrid(),x.updateState(c,h),e.resetObstacle()}),500)})),d.addEventListener("mousedown",e.handleMouseDown.bind(e)),d.addEventListener("mouseup",e.handleMouseUp.bind(e)),d.addEventListener("mousemove",e.handleMouseMove.bind(e)),p.addEventListener("click",e.resetPath.bind(e)),f.addEventListener("click",e.resetObstacle.bind(e)),u.addEventListener("click",(function(){let n;e.resetPath(g);const i=w.elements.searching.value;if("bfs"===i&&(n=((e,n,i)=>{const a=new t(null,n);a.g=a.h=a.f=0;const r=new t(null,i);r.g=r.h=r.f=0;const l=new s;l.enqueue(a),console.log("first frontier",l);const c=new Set;let h=[];if(e.goal_test(a.position))return a;for(;l.size>0;){let t=l.dequeue();console.log("dequeue",t),c.add(t.position);const s=t.expand(e);s.forEach((t=>h.push(t.position)));for(const t of s){const s=o([...c],t.position),n=l.find(t);if(console.log("is Fr",n),!s&&!n){if(e.goal_test(t.position))return[t.solution(),h];l.enqueue(t)}}}return[[],h]})(x,c,h)),"dfs"===i&&(n=((e,s,n)=>{const i=new t(null,s);i.g=i.h=i.f=0;const a=new t(null,n);a.g=a.h=a.f=0;const r=[i],l=new Set;let c=[];if(e.goal_test(i.position))return i;for(;r.length>0;){let t=r.pop();l.add(t.position);const s=t.expand(e);s.forEach((t=>c.push(t.position)));for(const t of s){const s=o([...l],t.position),n=r.some((e=>e===t));if(!s&&!n){if(e.goal_test(t.position))return[t.solution(),c];r.push(t)}}}return null})(x,c,h)),"astar"===i&&(n=((e,s,o)=>{const n=new t(null,s);n.g=n.h=n.f=0;const i=new t(null,o);i.g=i.h=i.f=0,console.log("test",n.position,i.position);const a=[],r=[],l=[];for(a.push(n);a.length>0;){let t=a[0],s=0;for(let e=0;e<a.length;e++){const o=a[e];o.f<t.f&&(t=o,s=e)}if(a.splice(s,1),r.push(t),e.goal_test(t.position))return[t.solution(),l];children=t.expand(e),children.forEach((t=>l.push(t.position)));for(const e of children){let s=!1;for(const t of r)if(e.position.equal(t.position)){s=!0;continue}if(!s){e.g=t.g+1,e.h=(e.position[0]-i.position[0])**2+(e.position[1]-i.position[1])**2,e.f=e.g+e.h;for(let t=0;t<a.length;t++){const s=a[t];e.position.equal(s.position)&&e.g<=s.g&&a.pop(t)}a.push(e)}}}})(x,c,h)),!n)return alert("no solution");[n,expand]=n,e.drawPath(expand);const a=e.drawLine(n);((t,e)=>{const s=document.createElementNS("http://www.w3.org/2000/svg","path");s.setAttributeNS(null,"stroke","Yellow"),s.setAttributeNS(null,"stroke-width",2),s.setAttributeNS(null,"fill","none"),s.setAttributeNS(null,"d",e),t.append(s)})(g,a)})),m.addEventListener("change",(function(t){const e=this.checked;x.updateDiagonal(e)})),v.forEach((t=>{t.addEventListener("dragstart",(()=>{t.classList.add("dragging")})),t.addEventListener("dragend",(()=>{t.classList.remove("dragging"),i(t,"start")&&(console.log("source is start"),c=n(L)),i(t,"goal")&&(console.log("source is end"),h=n(L)),i(L,"goal")&&(console.log("destination is end"),h=n(t)),i(L,"start")&&(console.log("destination is start"),c=n(t)),e.resetPath(),e.moveBox(t,L),x.updateState(c,h)}))})),d.addEventListener("dragover",(t=>{t.preventDefault();const e=t.path[0];L!==e&&(L=e)}))}));
//# sourceMappingURL=index.ffbcffc2.js.map
